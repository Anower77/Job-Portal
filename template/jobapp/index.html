{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- Enhanced Hero Section -->
<section class="home-section section-hero overlay bg-dark" id="home-section">
  <div class="container">
    <div class="row align-items-center justify-content-center min-vh-100">
      <div class="col-md-12 text-center">
        <div class="hero-content mb-5 animate__animated animate__fadeInUp">
          <h1 class="text-white font-weight-bold display-4 mb-4">
            Find Your Dream Job Today
          </h1>
          <p class="text-white-50 lead mb-5">
            Connect with top companies and discover opportunities that match your skills and aspirations
          </p>
        </div>
        
        <!-- Enhanced Search Form -->
        <form method="GET" action="{% url 'jobapp:search_result' %}" class="search-jobs-form animate__animated animate__fadeInUp animate__delay-1s">
          <div class="row mb-5">
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <div class="input-group input-group-lg">
                <span class="input-group-text bg-white border-0">
                  <i class="icon-search text-muted"></i>
                </span>
                <input name="job_title" class="form-control border-0 shadow-sm" type="text" 
                       placeholder="Job title, keywords..." value="{{ request.GET.job_title|default:'' }}">
              </div>
            </div>
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <select name="job_type" class="form-control form-control-lg" data-style="btn-white btn-lg" data-width="100%" data-live-search="true">
                <option value="">Job Type</option>
                <option value="1" {% if request.GET.job_type == '1' %}selected{% endif %}>Full Time</option>
                <option value="2" {% if request.GET.job_type == '2' %}selected{% endif %}>Part Time</option>
                <option value="3" {% if request.GET.job_type == '3' %}selected{% endif %}>Internship</option>
                <option value="4">Remote</option>
                <option value="5">Contract</option>
              </select>
            </div>
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <div class="input-group input-group-lg">
                <span class="input-group-text bg-white border-0">
                  <i class="icon-room text-muted"></i>
                </span>
                <input name="location" class="form-control border-0 shadow-sm" type="text" 
                       placeholder="Location" value="{{ request.GET.location|default:'' }}">
              </div>
            </div>
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <button type="submit" class="btn btn-primary btn-lg btn-block text-white btn-search">
                <i class="icon-search icon mr-2"></i>Search Jobs
              </button>
            </div>
          </div>
        </form>
        
        <!-- Popular Keywords -->
        <!-- <div class="popular-keywords mt-4 animate__animated animate__fadeInUp animate__delay-2s">
          <p class="text-white-50 mb-2">Popular:</p>
          <div class="keywords">
            <a href="?job_title=developer" class="btn btn-outline-light btn-sm mx-1 mb-2">Developer</a>
            <a href="?job_title=designer" class="btn btn-outline-light btn-sm mx-1 mb-2">Designer</a>
            <a href="?job_title=manager" class="btn btn-outline-light btn-sm mx-1 mb-2">Manager</a>
            <a href="?job_title=engineer" class="btn btn-outline-light btn-sm mx-1 mb-2">Engineer</a>
          </div>
        </div> -->
      </div>
    </div>
  </div>
  
  <!-- Scroll Indicator -->
  <div class="scroll-indicator text-center position-absolute bottom-0 start-50 translate-middle-x mb-4">
    <div class="mouse">
      <div class="mouse-icon">
        <div class="mouse-wheel"></div>
      </div>
    </div>
  </div>
</section>

<!-- Statistics Section -->
<section class="py-5 bg-image overlay-primary fixed overlay" id="stats-section">
  <div class="container">
    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2 text-white">Platform Statistics</h2>
        <p class="text-white-50">Join thousands of professionals and companies</p>
      </div>
    </div>
    <div class="row pb-0 block__19738 section-counter">
      <div class="col-6 col-md-6 col-lg-3 mb-5 mb-lg-0">
        <div class="stat-card text-center">
          <div class="stat-icon mb-3">
            <i class="icon-users text-white" style="font-size: 3rem;"></i>
          </div>
          <div class="d-flex align-items-center justify-content-center mb-2">
            <strong class="number display-4 text-white">{{ total_candidates|default:"10,000+" }}</strong>
          </div>
          <span class="caption text-white">Active Candidates</span>
        </div>
      </div>

      <div class="col-6 col-md-6 col-lg-3 mb-5 mb-lg-0">
        <div class="stat-card text-center">
          <div class="stat-icon mb-3">
            <i class="icon-briefcase text-white" style="font-size: 3rem;"></i>
          </div>
          <div class="d-flex align-items-center justify-content-center mb-2">
            <strong class="number display-4 text-white">{{ total_jobs|default:"5,000+" }}</strong>
          </div>
          <span class="caption text-white">Active Jobs</span>
        </div>
      </div>

      <div class="col-6 col-md-6 col-lg-3 mb-5 mb-lg-0">
        <div class="stat-card text-center">
          <div class="stat-icon mb-3">
            <i class="icon-check-circle text-white" style="font-size: 3rem;"></i>
          </div>
          <div class="d-flex align-items-center justify-content-center mb-2">
            <strong class="number display-4 text-white">{{ total_completed_jobs|default:"2,500+" }}</strong>
          </div>
          <span class="caption text-white">Jobs Filled</span>
        </div>
      </div>

      <div class="col-6 col-md-6 col-lg-3 mb-5 mb-lg-0">
        <div class="stat-card text-center">
          <div class="stat-icon mb-3">
            <i class="icon-building text-white" style="font-size: 3rem;"></i>
          </div>
          <div class="d-flex align-items-center justify-content-center mb-2">
            <strong class="number display-4 text-white">{{ total_companies|default:"500+" }}</strong>
          </div>
          <span class="caption text-white">Companies</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Featured Jobs Section -->
<section class="site-section py-5" id="featured-jobs">
  <div class="container">
    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2">Featured Jobs</h2>
        <p class="text-muted">Discover the most exciting opportunities</p>
      </div>
    </div>

    {% if page_obj %}
    <div class="row">
      {% for job in page_obj|slice:":6" %}
      <div class="col-lg-6 mb-4">
        <div class="job-card card h-100 shadow-sm border-0 hover-lift">
          <div class="card-body p-4">
            <div class="d-flex align-items-start mb-3">
              <div class="job-logo mr-3">
                <img src="{% static 'images/job_logo_1.jpg' %}" alt="Company Logo" 
                     class="rounded-circle" style="width: 60px; height: 60px; object-fit: cover;">
              </div>
              <div class="flex-grow-1">
                <h5 class="card-title mb-1">
                  <a href="{% url 'jobapp:single-job' job.id %}" class="text-decoration-none">{{ job.title }}</a>
                </h5>
                <p class="text-muted mb-2">{{ job.company_name }}</p>
                <div class="d-flex align-items-center text-muted small">
                  <i class="icon-room mr-1"></i>
                  <span>{{ job.location }}</span>
                  <span class="mx-2">•</span>
                  <i class="icon-clock-o mr-1"></i>
                  <span>{{ job.timestamp|date:"M d" }}</span>
                </div>
              </div>
              <div class="ml-auto">
                {% if job.job_type == '1' %}
                <span class="badge badge-success">Full Time</span>
                {% elif job.job_type == '2' %}
                <span class="badge badge-warning">Part Time</span>
                {% else %}
                <span class="badge badge-info">Internship</span>
                {% endif %}
              </div>
            </div>
            <p class="card-text text-muted">{{ job.description|truncatewords:20 }}</p>
            <div class="d-flex justify-content-between align-items-center">
              <div class="salary-info">
                <span class="text-success font-weight-bold">$50k - $80k</span>
              </div>
              <a href="{% url 'jobapp:single-job' job.id %}" class="btn btn-outline-primary btn-sm">
                Apply Now
              </a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    
    <div class="text-center mt-4">
      <a href="{% url 'jobapp:job-list' %}" class="btn btn-primary btn-lg">View All Jobs</a>
    </div>
    {% else %}
    <div class="text-center py-5">
      <i class="icon-briefcase text-muted" style="font-size: 4rem;"></i>
      <h4 class="mt-3 text-muted">No jobs available at the moment</h4>
      <p class="text-muted">Check back later for new opportunities</p>
    </div>
    {% endif %}
  </div>
</section>

<!-- Top Companies Section -->
<section class="site-section py-5 bg-light" id="top-companies">
  <div class="container">
    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2">Top Hiring Companies</h2>
        <p class="text-muted">Work with industry leaders</p>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="company-card text-center p-4 bg-white rounded shadow-sm">
          <!-- <img src="{% static 'images/logo_apple.svg' %}" alt="Apple" class="mb-3" style="height: 60px;"> -->
          <h5>Apple Inc.</h5>
          <p class="text-muted small">15 open positions</p>
          <a href="#" class="btn btn-outline-primary btn-sm">View Jobs</a>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="company-card text-center p-4 bg-white rounded shadow-sm">
          <!-- <img src="{% static 'images/logo_google.png' %}" alt="Google" class="mb-3" style="height: 60px;"> -->
          <h5>Google</h5>
          <p class="text-muted small">23 open positions</p>
          <a href="#" class="btn btn-outline-primary btn-sm">View Jobs</a>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="company-card text-center p-4 bg-white rounded shadow-sm">
          <!-- <img src="{% static 'images/logo_microsoft.svg' %}" alt="Microsoft" class="mb-3" style="height: 60px;"> -->
          <h5>Microsoft</h5>
          <p class="text-muted small">18 open positions</p>
          <a href="#" class="btn btn-outline-primary btn-sm">View Jobs</a>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 mb-4">
        <div class="company-card text-center p-4 bg-white rounded shadow-sm">
          <!-- <img src="{% static 'images/logo_amazon.svg' %}" alt="Amazon" class="mb-3" style="height: 60px;"> -->
          <h5>Amazon</h5>
          <p class="text-muted small">32 open positions</p>
          <a href="#" class="btn btn-outline-primary btn-sm">View Jobs</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Testimonials Section -->
<section class="site-section py-5" id="testimonials">
  <div class="container">
    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2">What Our Users Say</h2>
        <p class="text-muted">Success stories from job seekers and employers</p>
      </div>
    </div>
    
    <div class="row">
      <div class="col-lg-4 mb-4">
        <div class="testimonial-card card h-100 border-0 shadow-sm">
          <div class="card-body p-4">
            <div class="d-flex align-items-center mb-3">
              <img src="{% static 'images/person_1.jpg' %}" alt="User" class="rounded-circle mr-3" style="width: 50px; height: 50px;">
              <div>
                <h6 class="mb-0">Sarah Johnson</h6>
                <small class="text-muted">Software Engineer at Google</small>
              </div>
            </div>
            <p class="card-text">"Found my dream job within 2 weeks! The platform made it so easy to connect with top companies."</p>
            <div class="text-warning">
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4 mb-4">
        <div class="testimonial-card card h-100 border-0 shadow-sm">
          <div class="card-body p-4">
            <div class="d-flex align-items-center mb-3">
              <img src="{% static 'images/person_2.jpg' %}" alt="User" class="rounded-circle mr-3" style="width: 50px; height: 50px;">
              <div>
                <h6 class="mb-0">Mike Chen</h6>
                <small class="text-muted">HR Manager at TechCorp</small>
              </div>
            </div>
            <p class="card-text">"As an employer, I've found amazing talent through this platform. The quality of candidates is outstanding."</p>
            <div class="text-warning">
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4 mb-4">
        <div class="testimonial-card card h-100 border-0 shadow-sm">
          <div class="card-body p-4">
            <div class="d-flex align-items-center mb-3">
              <img src="{% static 'images/person_3.jpg' %}" alt="User" class="rounded-circle mr-3" style="width: 50px; height: 50px;">
              <div>
                <h6 class="mb-0">Emily Rodriguez</h6>
                <small class="text-muted">UX Designer at Apple</small>
              </div>
            </div>
            <p class="card-text">"The job matching algorithm is incredible. It found positions that perfectly matched my skills and interests."</p>
            <div class="text-warning">
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
              <i class="icon-star"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Blog/Tips Section -->
<section class="site-section py-5 bg-light" id="blog-tips">
  <div class="container">
    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2">Career Tips & Insights</h2>
        <p class="text-muted">Stay updated with the latest career advice</p>
      </div>
    </div>
    
    <div class="row">
      <div class="col-lg-4 mb-4">
        <div class="blog-card card h-100 border-0 shadow-sm">
          <img src="{% static 'images/sq_img_1.jpg' %}" class="card-img-top" alt="Blog Post">
          <div class="card-body p-4">
            <div class="d-flex align-items-center mb-2">
              <small class="text-muted">Career Tips</small>
              <small class="text-muted ml-auto">3 days ago</small>
            </div>
            <h5 class="card-title">How to Ace Your Job Interview</h5>
            <p class="card-text text-muted">Learn the essential tips and techniques to make a great impression during your job interview.</p>
            <a href="#" class="btn btn-link p-0">Read More →</a>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4 mb-4">
        <div class="blog-card card h-100 border-0 shadow-sm">
          <img src="{% static 'images/sq_img_2.jpg' %}" class="card-img-top" alt="Blog Post">
          <div class="card-body p-4">
            <div class="d-flex align-items-center mb-2">
              <small class="text-muted">Resume Tips</small>
              <small class="text-muted ml-auto">1 week ago</small>
            </div>
            <h5 class="card-title">Building a Standout Resume</h5>
            <p class="card-text text-muted">Discover the key elements that make your resume stand out from the competition.</p>
            <a href="#" class="btn btn-link p-0">Read More →</a>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4 mb-4">
        <div class="blog-card card h-100 border-0 shadow-sm">
          <img src="{% static 'images/sq_img_3.jpg' %}" class="card-img-top" alt="Blog Post">
          <div class="card-body p-4">
            <div class="d-flex align-items-center mb-2">
              <small class="text-muted">Remote Work</small>
              <small class="text-muted ml-auto">2 weeks ago</small>
            </div>
            <h5 class="card-title">Thriving in Remote Work</h5>
            <p class="card-text text-muted">Essential strategies for maintaining productivity and work-life balance in remote positions.</p>
            <a href="#" class="btn btn-link p-0">Read More →</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Enhanced CTA Section -->
<section class="py-5 bg-image overlay-primary fixed overlay" id="cta-section">
  <div class="container">
    {% if request.user.role == "employer" %}
    <div class="row align-items-center">
      <div class="col-md-8">
        <h2 class="text-white mb-3">Ready to Hire Top Talent?</h2>
        <p class="mb-0 text-white lead">Post your job openings and connect with qualified candidates from around the world.</p>
      </div>
      <div class="col-md-4 text-md-right">
        <a href="{% url 'jobapp:create-job' %}" class="btn btn-warning btn-lg">Post Your Job</a>
      </div>
    </div>
    {% elif request.user.role == "employee" %}
    <div class="row align-items-center">
      <div class="col-md-8">
        <h2 class="text-white mb-3">Ready to Find Your Next Opportunity?</h2>
        <p class="mb-0 text-white lead">Browse thousands of job openings and find the perfect match for your career goals.</p>
      </div>
      <div class="col-md-4 text-md-right">
        <a href="{% url 'jobapp:job-list' %}" class="btn btn-warning btn-lg">Browse Jobs</a>
      </div>
    </div>
    {% else %}
    <div class="row align-items-center">
      <div class="col-md-8">
        <h2 class="text-white mb-3">Join Our Community Today</h2>
        <p class="mb-0 text-white lead">Whether you're looking for a job or hiring talent, we've got you covered.</p>
      </div>
      <div class="col-md-4 text-md-right">
        <div class="d-flex flex-column">
          <a href="{% url 'account:employee-registration' %}" class="btn btn-warning btn-lg mb-2">Find Jobs</a>
          <a href="{% url 'account:employer-registration' %}" class="btn btn-outline-light btn-lg">Hire Talent</a>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
</section>

<!-- Job Listing Section (if any jobs exist) -->
{% if page_obj %}
<section id="ajax_listing_paginattion" class="site-section py-5">
  <div class="container">
    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2">{{ total_jobs }} Jobs Available</h2>
        <p class="text-muted">Find your perfect opportunity</p>
      </div>
    </div>

    <!-- Enhanced Job Listings -->
    <div class="row">
      {% for job in page_obj %}
      <div class="col-lg-6 mb-4">
        <div class="job-card card h-100 shadow-sm border-0 hover-lift">
          <div class="card-body p-4">
            <div class="d-flex align-items-start mb-3">
              <div class="job-logo mr-3">
                <img src="{% static 'images/job_logo_1.jpg' %}" alt="Company Logo" 
                     class="rounded-circle" style="width: 60px; height: 60px; object-fit: cover;">
              </div>
              <div class="flex-grow-1">
                <h5 class="card-title mb-1">
                  <a href="{% url 'jobapp:single-job' job.id %}" class="text-decoration-none">{{ job.title }}</a>
                </h5>
                <p class="text-muted mb-2">{{ job.company_name }}</p>
                <div class="d-flex align-items-center text-muted small mb-2">
                  <i class="icon-room mr-1"></i>
                  <span>{{ job.location }}</span>
                  <span class="mx-2">•</span>
                  <i class="icon-clock-o mr-1"></i>
                  <span>{{ job.timestamp|date:"M d" }}</span>
                </div>
              </div>
              <div class="ml-auto">
                {% if job.job_type == '1' %}
                <span class="badge badge-success">Full Time</span>
                {% elif job.job_type == '2' %}
                <span class="badge badge-warning">Part Time</span>
                {% else %}
                <span class="badge badge-info">Internship</span>
                {% endif %}
              </div>
            </div>
            <p class="card-text text-muted">{{ job.description|truncatewords:15 }}</p>
            <div class="d-flex justify-content-between align-items-center">
              <div class="salary-info">
                <span class="text-success font-weight-bold">Competitive Salary</span>
              </div>
              <a href="{% url 'jobapp:single-job' job.id %}" class="btn btn-outline-primary btn-sm">
                View Details
              </a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    
    {% include 'jobapp/paginator.html' %}
  </div>
</section>
{% endif %}

{% endblock %}

{% block extra_scripts %}
<script>
// Smooth scroll for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Add scroll animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('animate__animated', 'animate__fadeInUp');
        }
    });
}, observerOptions);

// Observe all cards and sections
document.querySelectorAll('.job-card, .company-card, .testimonial-card, .blog-card, .stat-card').forEach(el => {
    observer.observe(el);
});

// Add hover effects
document.querySelectorAll('.hover-lift').forEach(card => {
    card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-5px)';
        this.style.transition = 'transform 0.3s ease';
    });
    
    card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
    });
});

// Animate counters
document.querySelectorAll('.number').forEach(counter => {
    const target = parseInt(counter.textContent.replace(/,/g, ''));
    if (!isNaN(target)) {
        let current = 0;
        const increment = target / 100;
        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                counter.textContent = target.toLocaleString();
                clearInterval(timer);
            } else {
                counter.textContent = Math.floor(current).toLocaleString();
            }
        }, 20);
    }
});
</script>
{% endblock %}


